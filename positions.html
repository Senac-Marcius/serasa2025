<!DOCTYPE html>

    <head>
        <meta charset="UTF-8"/>
            <title>Cargos</title>
            <style>
                body{
                    margin: 0;
                }

                h1{
                    text-align: center;
                    color: #8525dd;
                    background-color: #f3f3f3;

                }

                section{
                    display: flex;
                    margin: 0 auto;
                    flex-direction: column;
                }

                section#scRegister{

                }
                section#scList{

                }

                .row{
                    display: flex;
                    margin-top: 50px;
                    padding: 20px;
                }

                label{
                    font-weight: 600;
                }

                br{
                    margin: 10px;
                }

                button{
                    background: linear-gradient(135deg, #6e8efb, #a777e3);
                    color: white;
                    border: none;
                    padding: 12px 24px;
                    font-size: 16px;
                    font-weight: bold;
                    cursor: pointer;
                    border-radius: 8px;
                    box-shadow: 0px 4px 10px rgba(0,0, 0, 0.2);
                    transition: all 0.3s ease-in-out;
                    position: relative;
                    overflow: hidden;
                    margin: 20px auto 0;
                    display: block;

                

                }


                button:hover{
                    background: linear-gradient(135deg, #5b77e0, #925ec4);
                    box-shadow: 0px 6px 15px rgba(0,0, 0, 0.3);
                    transform: translate(-2px)
                }

                button:active{
                    transform: translateY(1px);
                    box-shadow: 0px 6px 15px rgba(0,0, 0, 0.2);
                }

                button.round {
                    width: 35px;
                    height: 35px;
                    border-radius: 50%;
                }

                button.dell{
                    background: #ff0000;
                }

                button.edit{
                    background: #ffff00;
                }

                form{
                    background-color:#f2f2f2;
                    padding: 40px;
                    border-radius: 20px;
                    box-shadow: 0px 4px 10px rgba(0,0, 0, 0.2);
                }

            </style>
    </head>
    <body>
        <h1>Cadastros de Cargos</h1>
        <div class="row">
            <section id="scRegister">
                <form>
                    <input id="id" type = "hidden" value = "-1"/>
                    <label>Cargo: </label><input id="positions" type="text" /><br><p>
                    <label>Descrição: </label><input id="description" type="text" /><br></p>
                    <label>Salário: </label><input id="salary" type="currency" /><br></p>
                    <label>Horas trabalhadas: </label><input id="workHours" type="time" /><label> por dia.</label><br></p>
                    <label>Departamento: </label><input id="department" type="text" /><br></p>
                    <label>Supervisor: </label><input id="supervisor" type="text" /><br></p>
                    <label>Data: </label><input id="date" type="date" /><br></p>
                    <button type="button" id="register" onclick="handleRegister()">Cadastrar</button><br>
                    
                </form>
            </section>
            <section id="scList">
                <table>
                    <thead>
                        <th>Cargos</th>
                    </thead>
                    <tbody>

                    </tbody>
                    
                </table>
            </section>
        </div>
    </body>
    <script>
        var positions = []
        function setPositions(req){
            const datepattern = /^\d{4}-\d{2}-\d{2}$/;
            const urlpattern = /^https:\/\/[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

            if(!datepattern.test(req.creatAt)){
                return "O campo data deve conter o seguinte formato YYYY-MM-DD"
            }

            if(req.description.length > 900){
                return "O campo description deve conter até 900 caracters."

            }

            let p = {
                id: positions.length, 
                name: req.name,
                description: req.description,
                salary: req.salary,
                workHours: req.workHours,
                department: req.department,
                supervisor: req.supervisor,
                creatAt: req.creatAt,
            }

            positions.push(p)
            return "Cadastrado com sucesso!"
        }
        
        function putPosition(req, id){
            let idx = positions.findIndex(p => p.id == id)
            if (idx !== -1) {

                if(req.description != undefined) positions[idx].description = req.description
                if(req.name != undefined) positions[idx].name = req.name
                if(req.salary != undefined) positions[idx].salary = req.salary
                if(req.workHours != undefined) positions[idx].workHours = req.workHours
                if(req.department != undefined) positions[idx].department = req.department
                if(req.supervisor != undefined) positions[idx].supervisor = req.supervisor
                if(req.creatAt != undefined) positions[idx].creatAt = req.creatAt
            }
            return positions[idx]

            
        }

        function handleRegister(){
            let id = document.getElementById("id").value
            
            if(id == -1){
                    setPositions({
                        name: document.getElementById("positions").value,
                        description: document.getElementById("description").value,
                        salary: document.getElementById("salary").value,
                        workHours: document.getElementById("workHours").value,
                        department: document.getElementById("department").value,
                        supervisor: document.getElementById("supervisor").value,
                        creatAt: document.getElementById("date").value,
                    })
                    listPositions(positions)
                }else{
                putPosition({
                        name: document.getElementById("positions").value,
                        description: document.getElementById("description").value,
                        salary: document.getElementById("salary").value,
                        workHours: document.getElementById("workHours").value,
                        department: document.getElementById("department").value,
                        supervisor: document.getElementById("supervisor").value,
                        creatAt: document.getElementById("date").value,
                },id)
                        listPositions(positions)
                        document.getElementById("id").value = -1
                console.log("Erro")
            }
            
        }

        function editPosition (id){
            let  position = positions.find(p => p.id == id);
            document.getElementById("id").value = position.id
            document.getElementById("positions").value = position.name
            document.getElementById("description").value = position.description
            document.getElementById("salary").value = position.salary
            document.getElementById("workHours").value = position.workHours
            document.getElementById("department").value = position.department
            document.getElementById("supervisor").value = position.supervisor
            document.getElementById("date").value = position.creatAt
            
        }

        function listPositions (pList){
            const tbody = document.querySelector("#scList tbody")
            tbody.innerHTML = ""

            pList.forEach(p => {
                const row = document.createElement("tr");

                const nameCell = document.createElement("td");
                nameCell.textContent = p.name

                const cellDell = document.createElement("td");
                const buttonDel = document.createElement("button");
                buttonDel.className = "round dell";
                cellDell.appendChild(buttonDel);

                const editCell = document.createElement("td");
                const editButton = document.createElement("button");
                editButton.className = "round edit";
                editButton.onclick = function(){
                    editPosition (p.id);
                };

                editCell.appendChild(editButton);
                
                row.appendChild(nameCell);
                row.appendChild(cellDell);
                row.appendChild(editCell);

                tbody.appendChild(row);
            })
        }
    </script>
</html>