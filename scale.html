<!DOCTYPE html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8"/>
        <title>Escala</title>
        <style>
           body{
                background-color: rgba(75, 75, 75, 0.568);
                margin: 0;
           }
           h1{
                text-align: center;
                color: #BF54A3;
                background-color: #F2F2F2;
                margin: 0;
            }
            section{
                display: flex;
                margin: 0 auto;
                flex-direction: column;
            }
            #scRegister{
                text-align: left;
                color: #BF54A3;
                background-color: #F2F2F2;
            }

            #scList{
                text-align: -webkit-right;
                color: #BF54A3;
                background-color: #F2F2F2
            }
            
            .row{
                display:flex;
                margin-top: 50px;
                padding: 20px;

            }
            label {
                font-weight: 600;
            }

            form{
                background-color:#F2F2F2;
                padding: 40px;
                border-radius: 20px;
                box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
            }
            button {
                background: linear-gradient(135deg, #6e8efb, #a777e3);
                color: white;
                border: none;
                padding: 12px 24px;
                font-size: 16px;
                font-weight: bold;
                border-radius: 8px;
                box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
                cursor: pointer;
                transition: all 0.3s ease-in-out;
                position: relative;
                overflow: hidden;
                margin: 20px auto 0;
                display: block;
            }

            button:hover {
                background: linear-gradient(135deg, #5b77e0, #925ec4);
                box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.3);
                transform: translateY(-2px);
            }

            button:active {
                transform: translateY(1px);
                box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.2);
            }

            button.roud {
                width: 35px;
                height: 35px;
                border-radius: 50%;
            }

            button.edit {
                background: #ff0000;

            }
            
            button.dell {
                background: #ffff00;
                
            }

        </style>
    </head>
    <body>
        <h1>Cadastro de Escala</h1>
        <div class="row">
            <section id="scRegister">
                <form>
                    <input id="id" type="hidden" value="-1"/>
                    <label for="day">Dia da semana:</label>
                    <select id="day" name="day">
                    <option value="domingo">Domingo</option>
                    <option value="segunda-feira">Segunda-feira</option>
                    <option value="terca-feira">Terça-feira</option>
                    <option value="quarta-feira">Quarta-feira</option>
                    <option value="quinta-feira">Quinta-feira</option>
                    <option value="sexta-feira">Sexta-feira</option>
                    <option value="sabado">Sábado</option>
                    </select><br><br>
                    
                    <label>Horário de início:</label><input id="starttime" type="time">
        
                    <label>Horário de término:</label><input id="endtime" type="time" /><br><br>
        
                    <label>Data:</label><input id="createAt" type="date" /><br><br>
        
                    <button type="button" id="register" onclick="handleRegister()"> CADASTRAR</button>
                </form>
            </section>

            <section id="scList">

                <table>
                    <thead>
                        <th>Dia</th>
                    </thead>
                    <tbody>
                
                    </tbody>
                </table>
            </section>
        </div>
    </body>

    <script>

        var scales =[]

        function setScales(req){
            const timePattern = /^([01]?[0-9]|2[0-3]):([0-5][0-9])$/;
            const intPattern = /^[0-9]+$/;
            const dayPattern = [
                "domingo", "segunda-feira", "terca-feira", "quarta-feira", 
                "quinta-feira", "sexta-feira", "sabado"
            ];

            if(!dayPattern.includes(req.day)){
                return "O formato do dia da semana deve ser inteira. EX: segunda-feira"
            }

            if(!timePattern.test(req.starttime)){
                return "O formato da hora de início deve ser HH:MM."
            }

            if(!timePattern.test(req.endtime)){
                return "O formato da hora de término deve ser HH:MM."
            }

            if(!intPattern.test(req.userId)){
                return "Campo userID deve conter apenas números."
            }

            let s = {
                id: scales.length -1,
                day: req.day,
                starttime: req.starttime,
                endtime: req.endtime,
                
                
                userId: req.userId
        }
        
        scales.push(s)
        return "Escala Cadastrada"
        }
        
        function handleRegister(req,id){
            let idx = document.getElementById("id").value

            if(id == -1){
                console.log(
                setScales({
                    day: document.getElementById("day").value,
                    starttime: document.getElementById("starttime").value,
                    endtime: document.getElementById("endtime").value,
                    createAt: document.getElementById("createAt").value,
                    userId: "0"
                })
                )

            }else if(id > -1){
                putScale(req,id)
                    
                        if(req.day != undefined)scales[idx].day = req.day
                        if(req.starttime != undefined)scales[idx].starttime = req.starttime
                        if(req.endtime != undefined)scales[idx].endtime = req.endtime
                        if(req.createAt != undefined)scales[idx].createAt= req.createAt
                        if(req.userId!= undefined)scales[idx].userId = req.userId

                        return scales[idx]

                        scales[idx]
                
                
                document.getElementById('id').value = -1
                

            }else{
                console.log("Erro")
            }
            
            listScales(scales)
        }
    
        function editScale(id){
            let scale= scales.find(s => s.id == id)

            document.getElementById("id").value = scale.id
            document.getElementById("day").value = scale.day
            document.getElementById("starttime").value = scale.starttime
            document.getElementById("endtime").value = scale.endtime
            document.getElementById("createAt").value = scale.createAt
        }

        function listScales(sList){
            const tbody = document.querySelector("#scList tbody")
            tbody.innerHTML = ""
        
            sList.forEach(s =>{
                const row = document.createElement("tr");
            
                const dayCell = document.createElement("td");
                dayCell.textContent = s.day;

                const editButton = document.createElement("button");
                const editCell = document.createElement("td");
                editButton.className = " roud edit"
                editButton.onclick = function(){
                    editScale(s.id)
                };
                editCell.appendChild(editButton);

                const dellButton = document.createElement("button");
                const dellCell = document.createElement("td");
                dellButton.className = " roud dell"
                dellCell.appendChild(dellButton);
                

                row.appendChild(dayCell);
                row.appendChild(editCell);
                row.appendChild(dellCell);
                tbody.appendChild(row);
            })
        }
    </script>
</html>