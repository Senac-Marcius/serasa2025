<!DOCTYPE html>
<html lang="pt-BR">

<head>
    
    <title>Cadastro de Funcionários</title>
    
    <style>
        body{
            background-color: #C7D4D9;
        }
        h1 {
            TEXT-ALIGN: center;
            COLOR: #3B3C40;
            font-family: math;
        }
        section {
            display: flex;
            margin: 0 auto;
            flex-direction: column;
        }
        form{
            background-color: #f2f2f2;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
        }

        .row{
            display: flex;
            margin-top: 50px;
            padding: 20px;
        }
        .buttonsArea{
            display: grid;
            margin-top: 50px;
            padding: 20px;     
        }
        label{
            font-weight: 600;
            padding-left: 10px;
        }
        br{
        }
        button {
                background: linear-gradient(135deg, #6e8efb, #a777e3);
                color: white;
                border: none;
                padding: 12px 24px;
                font-size: 16px;
                font-weight: bold;
                border-radius: 8px;
                box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
                cursor: pointer;
                transition: all 0.3s ease-in-out;
                position: relative;
                overflow: hidden;
                margin: 20px auto 0;
                display: block;
            }

            button:hover {
                background: linear-gradient(135deg, #5b77e0, #925ec4);
                box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.3);
                transform: translateY(-2px);
            }

            button:active {
                transform: translateY(1px);
                box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.2);
            }



    </style>
</head>

<body>
    <h1 >Formulario para cadastro de funcionário</h1>
    <div  class="row">
    <section id="eResgister">
        <form id="formEmployee" >
            <label for="urls">Perfil do Linkedin: </label><input type="text" id="urls" name="urls" placeholder="Insira um perfil (linkedin , catho , etcs..)" /><br>
            <label for="name">Nome Completo: </label><input type="text" id="name" /><br>
            <label for="age">Data de Nascimento: </label><input type="date" id="age" name="age" placeholder="MM/DD/YYYY" maxlength="10"><br>
            <label for="tell">Telefone de Contato: </label><input type="tel" id="tell" name="tell" placeholder="(00) 00000-0000" maxlength="15"><br>
            <label for="email">Email: </label><input type="email" id="email" name="email" placeholder="emailtest@test.com.ts"><br>
            <label for="cep">CEP:</label><input type="text" id="cep" name="cep" onblur="buscarEndereco()" placeholder="00000-000"><label for="address">Endereço: </label><input type="text" id="address" name="address" disabled><br>
            <label for="nationality">Nacionalidade: </label><input type="text" id="nationality" name="nationality"><br>
            <label for="cpf">C.P.F: </label><input type="text" id="cpf" name="cpf" placeholder="000.000.000-00" pattern="\d{3}\.\d{3}\.\d{3}-\d{2}"required /><br>
            <label for="sex">Gênero:</label><select id="sex" name="sex" onchange="handleOtherOption()">
                <option value="null">Selecione uma opção</option>
                <option value="male">Masculino</option>5
                <option value="female">Feminino</option>
                <option value="other">Outro(a)(e)</option>
            </select>
            <div id="otherSexContainer" style="display: none;">
                <input type="text" id="otherSexInput" name="otherSex" placeholder="Especifique o gênero">
            </div><br>
            <label>Estado Civil:</label>
            <select id="martialStatus" name="martialStatus">
                <option value="Null">Insira o perfil</option>
                <option value="Solteiro(a)">Solteiro(a)</option>
                <option value="Divorciado(a)">Divorciado(a)</option>
                <option value="Casado(a)">Casado(a)</option>
                <option value="Viuvo(a)">Viuvo(a)</option>
            </select><br>
            <label for="discPersonality">Personalidade: </label>
            <select id="discPersonality" name="discPersonality">
                <option value="Null">Insira o perfil</option>
                <option value="Dominância">Dominância</option>
                <option value="Influência">Influência</option>
                <option value="Estabilidade">Estabilidade</option>
                <option value="Cautela">Cautela</option>
            </select><br>
            <label for="position">Cargo:</label><input type="text" id="position" name="position" /><br>
            <label for="ethnicity">Etinia:</label><input type="text" id="ethnicity" name="ethnicity" /><br>
            <label for="deficiency">Deficiência:</label>
            <select id="deficiency" name="deficiency" onchange="handleOtherOptionD()">
                <option value="null">Selecione uma opção</option>
                <option value="true">Sim, Possui deficiência</option>
                <option value="false">Não, não possui deficiência</option>
            </select><br>
            <div id="otherDeficiency" style="display: none;">
                <input type="text" id="otherDeficiency" name="otherDeficiency" placeholder="Especifique a deficiência">
            </div>
            <label id="createAt"></label><label for="isActive">Estado na empresa:</label>
            <select id="isActive">
                <option value="Null">Selecione um estado</option>
                <option value="true">Está ativo</option>
                <option value="false">Está inativo</option>
            </select><br>
            <button type="button" id="register" onclick="handleRegister()">CADASTRAR</button><br>
        </form>
    </section>
    <section id="esList">
        <table>
            <thead>
                <th>LISTA DE FUNCIONÁRIOS</th>
            </thead>
            <tbody>

            </tbody>
        </table>
    </section>
</div>
</body>
<script>
    var employees = []
    
    const dataAtual = new Date();
    const dataFormatada = dataAtual.toLocaleDateString('en-US');
    document.getElementById('createAt').innerText = "Entrou em: " + dataFormatada;
    document.getElementById("age").toLocaleDateString(`en-US`);

    function handleOtherOptionD() {
                    const select = document.getElementById("deficiency");
                    const otherInputContainer = document.getElementById("otherDeficiency");
                    var sex = otherInputContainer.value
                    if (select.value === "true") {
                        otherInputContainer.style.display = "block";
                    } else {
                        otherInputContainer.style.display = "none";
                    }
                }
    function handleOtherOption() {
                    const select = document.getElementById("sex");
                    const otherInputContainer = document.getElementById("otherSexContainer");
                    var sex = otherInputContainer.value
                    if (select.value === "other") {
                        otherInputContainer.style.display = "block";
                        console.log(document.getElementById("sex").value)
                    } else {
                        otherInputContainer.style.display = "none";
                    }
                }
    let cpf = document.getElementById("cpf")
    cpf.addEventListener("input", function (e) {
                    let value = e.target.value.replace(/\D/g, "");

                    if (value.length > 3) value = value.slice(0, 3) + "." + value.slice(3);
                    if (value.length > 7) value = value.slice(0, 7) + "." + value.slice(7);
                    if (value.length > 11) value = value.slice(0, 11) + "-" + value.slice(11);

                    e.target.value = value.slice(0, 14);

                });
    function buscarEndereco() {
                    let cep = document.getElementById('cep').value.replace(/\D/g, '');
                    if (cep.length === 8) {
                        fetch(`https://viacep.com.br/ws/${cep}/json/`)
                            .then(response => response.json())
                            .then(data => {
                                if (!data.erro) {
                                    document.getElementById('address').value = `${data.logradouro}, ${data.bairro}, ${data.localidade} - ${data.uf}`;
                                } else {
                                    alert('CEP não encontrado!');
                                    document.getElementById("address").disable = false
                                }
                            })
                            .catch(error => console.error('Erro ao buscar CEP:', error));
                    } else {
                        alert('CEP inválido!');
                    }
                }
    document.getElementById("tell").addEventListener("input", function (e) {
                    let value = e.target.value.replace(/\D/g, "")// Remove tudo que não for número

                    if (value.length > 2) value = `(${value.slice(0, 2)}) ${value.slice(2)}`
                    if (value.length > 7) value = `${value.slice(0, 10)}-${value.slice(10)}`

                    e.target.value = value.slice(0, 15); // Limita ao formato (XX) XXXXX-XXXX
                })
    function setEmployee(req) {

        const urlsPattern = /^(https?:\/\/)[\w\-]+(\.[\w\-]+)+[/#?]?.*$/ // URLs válidas
        const tellPattern = /^\(\d{2}\)\s\d{4,5}-\d{4}$/ // Formato de telefone (XX)XXXXX-XXXX
        const emailPattern = /^[\w.-]+@[a-zA-Z\d.-]+\.[a-zA-Z]{2,}$/ // E-mail válido
        const cpfPattern = /^\d{3}\.\d{3}\.\d{3}-\d{2}$/ // CPF no formato 000.000.000-00
        const datePattern = /^\d{4}\/\d{2}\/\d{2}$/;

        //if(!urlsPattern.test(req.urls))return "Campo URls deve conter apenas URLs válidas "
        //if(!datePattern.test(req.age))return "Campo Age deve conter apenas números e ter a idade mínima de 18"
        //if(!tellPattern.test(req.tell))return "Campo Tell deve seguir o formato de telefone (XX)XXXXX-XXXX"
        //if(!emailPattern.test(req.email))return "Campo email deve ter um e-mail válido "
        //if(!cpfPattern.test(req.cpf))return "Campo CPF deve estar no formato 000.000.000-00 "
        //if(!datePattern.test(req.createAt))return "Campo deve estar no formato YYYY-MM-DD"

        let e = {
            id: employees.length - 1,
            urls: req.urls,
            name: req.name,
            age: req.age,
            tell: req.tell,
            email: req.email,
            address: req.address,
            nationality: req.nationality,
            discPersonality: req.discPersonality,
            cpf: req.cpf,
            sex: req.sex,
            maritalStatus: req.maritalStatus,
            position: req.position,
            ethnicity: req.ethnicity,
            deficiency: req.deficiency,
            createAt: req.createAt,
            isActive: req.isActive
        }

        employees.push(e)
    }
    function handleRegister() {
        setEmployee({
            urls: document.getElementById("urls").value,
            name: document.getElementById("name").value,
            age: document.getElementById("age").value,
            tell: document.getElementById("tell").value,
            email: document.getElementById("email").value,
            address: document.getElementById("address").value,
            nationality: document.getElementById("nationality").value,
            discPersonality: document.getElementById("discPersonality").value,
            cpf: document.getElementById("cpf").value,
            sex: document.getElementById("sex").value,
            maritalStatus: document.getElementById("martialStatus").value,
            position: document.getElementById("position").value,
            ethnicity: document.getElementById("ethnicity").value,
            deficiency: document.getElementById("deficiency").value,
            createAt: dataFormatada,
            isActive: document.getElementById("isActive").value
        })
        document.getElementById("formEmployee").reset()
        listEmployees(employees)
        if (document.getElementById("sex").value == "other") {
            let otherSex = document.getElementById("otherSexInput").value
            document.getElementById("sex").value = othe
            const sGender = document.getElementById("sex")
            const option = document.createElement("option")
            option.innerHTML = document.getElementById("otherSexInput").value
            sGender.appendChild(option)
        }
    }
   
    function listEmployees(elist) {
        const t = document.querySelector("#esList tbody")
        t.innerHTML = ""

        elist.forEach(e => {
            const row = document.createElement("tr")
            const nameCell = document.createElement("td")
            const buttonView = document.createElement("td")
            const buttonDel = document.createElement("td")
            const buttonDelete = document.createElement("button")
            const buttonShow = document.createElement("button")

            nameCell.textContent = e.name
            buttonDelete.textContent = "Deletar"
            buttonShow.textContent = "Mostrar"
            buttonShow.addEventListener("click", showEmployye(e.id))
            buttonDelete.addEventListener("click", deleteEmployee())
            
            row.appendChild(nameCell)
            row.appendChild(buttonView)
            row.appendChild(buttonDel)
            buttonDel.appendChild(buttonDelete)
            buttonView.appendChild(buttonShow)
            t.appendChild(row)

        })

    }
    function showEmployye(id){
     if(employees.length == 0)return "Não ha usuarios para mostrar"
     let infoUser = employees.find(e => e.id == id)
     console.log(infoUser)
     const t = document.querySelector("#esList tbody")
     t.innerHTML = ""
     const rowInfo = document.createElement("tr")   
     const showInfo = document.createElement("td")
     showInfo.textContent = infoUser
     
     rowInfo.appendChild(showInfo)
     t.appendChild(rowInfo)

    }
    function deleteEmployee(id){
    if(employees.length == 0)return "Não ha usuarios para deletar"
    let idx = employees.findIndex(e => e.id == id)
    employees.splice(idx,1)
    return "Usuario deletado"
}           
</script>

</html>