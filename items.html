<!DOCTYPE html>

<html lang="pt-br">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Itens</title>
        <style>
            /*
            Paleta

            */
            body {
                font-family: Arial, sans-serif;
                margin: 0px;
                padding: 20px;
                background-color: #f4f4f4;
            }
            h1 {
                text-align: center;
                color: #2A17A6;
                background-color: #F2F2F2;
                margin: 0;
                padding: 20px;
            }
            h2{
                text-align: center;
            }
            section {
                display: flex;
                margin: 0 auto;
                flex-direction: column;
            }
            #scRegister{

            }
            #scList {

            }
            .row {
                display: flex;
                margin-top: 50px;
                padding: 20px;
            }
            label {
                display: block;
                margin-top: 10px;
                font-weight: 600;
            }
            br {
                margin: 10px;
            }
            button {
                background-color: linear-gradient(135deg, #6e8efb, #a777e3);
                color: white;
                border: none;
                padding: 12px 24px;
                font-size: 16px;
                font-weight: bold;
                margin-top: 15px;
                cursor: pointer;
                width: 100%;
                border-radius: 8px;
                box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
                transition: all 0.3s ease-in-out;
                position: relative;
                overflow: hidden;
                display: block;
            }
            button:hover {
                background-color: linear-gradient(135deg, #5b77e0, #925ec4);
                box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.3);
                transform: translateY(-2px);
            }
            button:active {
                transform: translateY(1px);
                box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.2);
            }
            button.round {
                width: 35px;
                height: 35px;
                border-radius: 50%;
            }
            button.edit{
                background-color: yellow;
            }
            button.dell{
                background-color: red;
            }

            form {
                background: #7139BF;
                color: white;
                padding: 40px;
                border-radius: 20px;
                box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
                max-width: 400px;
                margin: 0 auto;
            }
            input {
                width: 100%;
                padding: 8px;
                margin-top: 5px;
                border: 1px solid #ccc;
                border-radius: 4px;
            }
            table {
                width: 100%;
                margin-top: 20px;
                border-collapse: collapse;
                background: white;
            }
            th, td {
                border: 1px solid #ddd;
                padding: 10px;
                text-align: left;
            }
            th {
                background-color: #0F2259;
                color: white;
            }

        </style>
    </head>

    <body>
        <h1>Cadastramento de Itens</h1>
        <div class="row">
            <section id="scRegister">
                <form>
                    <input id ="id" type="hidden" value="-1"/>
                    <label>Título: </label><input id="title" type="text" /><br>
                    <label>Subtítulo: </label><input id="subtitle" type="text" /><br>
                    <label>Título Uniforme: </label><input id="uniformTitle" type="text" /><br>
                    <label>Responsáveis: </label><input id="responsible" type="text" /><br>
                    <label>Tradução: </label><input id="translation" type="text" /><br>
                    <label>Edição: </label><input id="edition" type="text" /><br>
                    <label>Local: </label><input id="location" type="text" /><br>
                    <label>Editora: </label><input id="publisher" type="text" /><br>
                    <label>Ano: </label><input id="year" type="number" /><br>
                    <label>Idioma: </label><input id="language" type="text" /><br>
                    <label>Número de páginas: </label><input id="numberPages" type="number" /><br>
                    <label>Formato: </label>
                    <select id="format" name="opcoes">
                        <option id="opcao1" value="opcao1">Físico</option>
                        <option id="opcao2" value="opcao2">Digital</option>
                    </select>
                    <br><br>
                    <label>Dimensões: </label><input id="dimensions" type="text" /><br>
                    <label>Ilustrações: </label><input id="illustrations" type="text" /><br>
                    <label>Série: </label><input id="serie" type="text" /><br>
                    <label>Volume: </label><input id="volume" type="number" /><br>
                    <label>ISBN: </label><input id="isbn" type="text" /><br>
                    <label>ISSN: </label><input id="issn" type="text" /><br>
                    <label>Assuntos: </label><input id="subject" type="text" /><br>
                    <label>Palavras-chave: </label><input id="keywords" type="text" /><br>
                    <label>Resumo: </label><textarea id="summary" type="text"></textarea><br>
                    <label>Notas: </label><textarea id="notes" type="text"></textarea><br>
                    <label>Material adicional e suplementos: </label><textarea id="additionalMaterial" type="text"></textarea><br>
                    <label>Periodicidade: </label><input id="periodicity" type="text" /><br>
                    <label>Data de início e encerramento: </label><input id="startEndDate" type="date" /><br>
                    <label>Instituição: </label><input id="institution" type="text" /><br>
                    <label>Grau: </label><input id="degree" type="text" /><br>
                    <label>Orientadores: </label><input id="advisors" type="text" /><br>
                    <label>Desenvolvedor: </label><input id="developer" type="text" /><br>
                    <label>Designer: </label><input id="designer" type="text" /><br>
                    <label>Plataforma: </label><input id="platform" type="text" /><br>
                    <label>Número de jogadores: </label><input id="numberPlayers" type="number" /><br>
                    <label>Faixa etária: </label><input id="ageGroup" type="number" /><br>
                    <label>Código de produto: </label><input id="productCode" type="text" /><br>
                    <label>Narrador: </label><input id="narrator" type="text" /><br>
                    <label>Duração: </label><input id="duration" type="text" /><br>
                    <label>Escala: </label><input id="scale" type="text" /><br>
                    <label>Coordenadas geográficas: </label><input id="geographicCoordinates" type="text" /><br>
                    <label>CDD: </label><input id="cdd" type="text" /><br>
                    <label>Número de Chamada: </label><input id="callNumber" type="text" /><br>
                    <label>Data de Criação: </label><input id="createAt" type="date" /><br>
                    <button type="button" id="register" onclick="handleRegister()">CADASTRAR</button>
                </form>
            </section>
            
            <section id="scList" >
                <table>
                    <thead>
                        <th>Itens</th>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
            </section>
        </div>
    </body>

    <script>
        var items =  [] // vetor

        function setItems (req){ //função de create
            const patterns = { //patterns = expressões regulares (regex)
                numberIntFields: /^\d+$/,  // Apenas números inteiros positivos
                textFields: /^[\p{L}\d\s.,;:()'"-]+$/u, // Para campos de texto. Para permitir caracteres acentuados e especiais comuns 
                year: /^\d{4}$/,  // Ano com 4 dígitos (ex: 2023)
                edition: /^\d+ª edição$/,  // Número + "ª edição" (ex: "1ª edição")
                dimensions: /^\d{2}\.\d{2} X \d{2}\.\d{2} cm$/,  // Formato "XX.XX X XX.XX cm"
                cdd: /^\d{3}(\.\d+)?$/,  // Código Decimal Dewey (ex: "150.195") com números e um ponto decimal.
                callNumber: /^[\w\d\s.-]*$/,  // Aceita letras, números, espaços, pontos e traços
                date: /^\d{4}-\d{2}-\d{2}$/, // Data no formato YYYY-MM-DD (Ex: 2019-12-05 / 2025-01-15)
                duration: /^([0-9]{2}):([0-5][0-9]):([0-5][0-9])$/, //formato HH:MM:SS (horas, minutos e segundos)
                //scale: /^1:\d{1,3}(\.\d{3})*$/, // formato 1:XXXXXX, onde XXXXXX pode ser um número inteiro ou decimal. Aceita pontos
                geographicCoordinates: /^(\d{1,3})°\s*(\d{1,2})'\s*(\d{1,2})"$/, //formato DDDº MM' SS" (graus, minutos e segundos).
            };
            // Valida os campos com regras específicas
            if (!patterns.numberIntFields.test(req.numberPages) || !patterns.numberIntFields.test(req.volume) || !patterns.numberIntFields.test(req.numberPlayers) || 
                !patterns.numberIntFields.test(req.ageGroup)){
                return "O campo deve conter apenas números"
            }
            if (!patterns.textFields.test(req.title) || !patterns.textFields.test(req.subtitle) || !patterns.textFields.test(req.uniformTitle) || !patterns.textFields.test(req.responsible) || 
                !patterns.textFields.test(req.translation) || !patterns.textFields.test(req.language) || !patterns.textFields.test(req.publisher) || !patterns.textFields.test(req.location) ||
                !patterns.textFields.test(req.format) || !patterns.textFields.test(req.illustrations) || !patterns.textFields.test(req.serie) || !patterns.textFields.test(req.subject) ||
                !patterns.textFields.test(req.keywords) || !patterns.textFields.test(req.summary) || !patterns.textFields.test(req.notes) || !patterns.textFields.test(req.additionalMaterial) ||
                !patterns.textFields.test(req.periodicity) || !patterns.textFields.test(req.institution) || !patterns.textFields.test(req.degree) || !patterns.textFields.test(req.advisors) ||
                !patterns.textFields.test(req.developer) || !patterns.textFields.test(req.designer) || !patterns.textFields.test(req.platform) || !patterns.textFields.test(req.narrator) || 
                !patterns.textFields.test(req.isbn) || !patterns.textFields.test(req.issn) || !patterns.textFields.test(req.productCode)){
                return "Contém caracteres inválidos!"
            }
            if (!patterns.year.test(req.year)){
                return "Use o formato padrão AAAA"
            }  
            if (!patterns.edition.test(req.edition)){
                return "Use o formato padrão:  Número + ª edição"
            }
            if (!patterns.dimensions.test(req.dimensions)){
                return "Dimensões inválidas! Use o formato padrão: 00 X 00 cm "
            } 
            if (!patterns.cdd.test(req.cdd)){
                return "CDD inválido! Use o formato padrão: 000.000";
            }
            if (!patterns.callNumber.test(req.callNumber)){
                return "Número de chamada inválido! Use o formato padrão: cdd + tabela Cutter + inicial do título. Ex 150.095 I12m"
            } 
            if (!patterns.date.test(req.startEndDate) || !patterns.date.test(req.createAt)){
                return "Use o formato padrão: AAAA-MM-DD"
            }
            if (!patterns.duration.test(req.duration)){
                return "Use o formato padrão: HH:MM:SS (horas, minutos e segundos)"
            }
            /*if (!patterns.scale.test(req.scale)){
                return "Use o formato padrão: 1:XXXXXX"
            }*/
            if (!patterns.geographicCoordinates.test(req.geographicCoordinates)){
                return "Inválido! Use o formato padrão: graus, minutos e segundos. Ex: 125° 58 14" 
            }

            let i = {
                id: items.length,
                createAt: req.createAt,
                title: req.title,
                subtitle: req.subtitle,
                uniformTitle: req.uniformTitle,
                responsible: req.responsible,
                translation: req.translation,
                year: req.year,
                language: req.language,
                edition: req.edition,
                publisher: req.publisher,
                location: req.location,
                numberPages: req. numberPages,
                format: req.format,
                dimensions: req.dimensions,
                illustrations: req.illustrations,
                serie: req.serie,
                volume: req.volume,       
                isbn: req.isbn,
                issn: req.issn,
                Cdd: req.cdd,
                callNumber: req.callNumber,
                subject: req.subject,
                keywords: req.keywords,
                summary: req.summary,
                notes: req.notes,
                additionalMaterial: req.additionalMaterial,
                periodicity: req.periodicity,
                startEndDate: req.startEndDate,
                institution: req.institution,
                degree: req.degree,
                advisors: req.advisors,
                developer: req.developer,
                designer: req.designer,
                platform: req.platform,
                numberPlayers: req.numberPlayers,
                ageGroup: req.ageGroup,
                productCode: req.productCode,
                narrator: req.narrator,
                duration: req.duration,
                //scale: req.scale,
                geographicCoordinates: req.geographicCoordinates,
            }
            items.push(i)
            return "Cadastrado"
        }

        function handleRegister(){
        
            let id = document.getElementById("id").value

            if(id == -1){
                console.log(
                    setItems({
                        //userId: 0,
                        createAt: "2025-02-25",
                        title: document.getElementById("title").value,
                        subtitle: document.getElementById("subtitle").value,
                        uniformTitle: document.getElementById("uniformTitle").value,
                        responsible: document.getElementById("responsible").value,
                        translation: document.getElementById("translation").value,
                        edition: document.getElementById("edition").value,
                        location: document.getElementById("location").value,
                        publisher:document.getElementById("publisher").value,
                        year: parseInt(document.getElementById("year").value) || 0,
                        language: document.getElementById("language").value,
                        numberPages: parseInt(document.getElementById("numberPages").value) || 0,
                        format: document.getElementById("format").value,
                        dimensions:document.getElementById("dimensions").value,
                        illustrations: document.getElementById("illustrations").value,
                        serie: document.getElementById("serie").value,
                        volume: parseInt(document.getElementById("volume").value) || 0, 
                        isbn: document.getElementById("isbn").value,
                        issn: document.getElementById("issn").value,
                        cdd: document.getElementById("cdd").value,
                        callNumber: document.getElementById("callNumber").value,
                        subject: document.getElementById("subject").value,
                        keywords: document.getElementById("keywords").value,
                        summary: document.getElementById("summary").value,
                        notes: document.getElementById("notes").value,
                        additionalMaterial: document.getElementById("additionalMaterial").value,
                        periodicity: document.getElementById("periodicity").value, 
                        startEndDate: document.getElementById("startEndDate").value,
                        institution: document.getElementById("institution").value,
                        degree: document.getElementById("degree").value,
                        advisors: document.getElementById("advisors").value,
                        developer: document.getElementById("developer").value,
                        designer: document.getElementById("designer").value,
                        platform: document.getElementById("platform").value,
                        numberPlayers: parseInt(document.getElementById("numberPlayers").value) || 0,
                        ageGroup: parseInt(document.getElementById("ageGroup").value) || 0,
                        productCode: document.getElementById("productCode").value,
                        narrator: document.getElementById("narrator").value,
                        duration: document.getElementById("duration").value,
                        //scale: document.getElementById("scale").value,
                        geographicCoordinates: document.getElementById("geographicCoordinates").value
                    })
                )
            }else if(id > -1){
                    //chamar a funcao de put
                document.getElementById("id").value = -1
            }else{
                console.log("erro")
            }

            listItems(items)
        }
        function putItems(){

        }
        function editItems(id){
            let item = items.find(i => i.id == id)

            document.getElementById("title").value = i.title
            document.getElementById("subtitle").value = i.subtitle
            document.getElementById("uniformTitle").value = i.uniformTitle
            document.getElementById("responsible").value = i.responsible
            document.getElementById("translation").value = i.translation
            document.getElementById("edition").value = i.edition
            document.getElementById("location").value = i.location
            document.getElementById("publisher").value = i.publisher
            document.getElementById("language").value = i.language
            document.getElementById("format").value = i.format
            document.getElementById("dimensions").value = i.
            document.getElementById("illustrations").value = i.
            document.getElementById("serie").value = i.serie
            document.getElementById("isbn").value = i.isbn
            document.getElementById("issn").value = i.issn
            document.getElementById("cdd").value = i.cdd
            document.getElementById("callNumber").value = i.callNumber
            document.getElementById("subject").value = i.subject
            document.getElementById("keywords").value = i.keywords
            document.getElementById("summary").value = i.summary
            document.getElementById("notes").value = i.notes
            document.getElementById("additionalMaterial").value = i.additionalMaterial
            document.getElementById("periodicity").value = i.periodicity 
            document.getElementById("startEndDate").value = i.startEndDate
            document.getElementById("institution").value = i.institution
            document.getElementById("degree").value = i.degree
            document.getElementById("advisors").value = i.advisors
            document.getElementById("developer").value = i.developer
            document.getElementById("designer").value = i.designer
            document.getElementById("platform").value = i.platform
            document.getElementById("productCode").value = i.productCode
            document.getElementById("narrator").value = i.narrator
            document.getElementById("duration").value = i.duration
           // document.getElementById("scale").value = i.scale
            document.getElementById("geographicCoordinates").value = i.geographicCoordinates
        }

        function listItems(iList){
            const tbody = document.querySelector("#scList tbody")
            tbody.innerHTML = "" // Limpa a tabela antes de atualizar

            iList.forEach(i => {
                const row = document.createElement("tr")

                const titleCell = document.createElement("td")
                titleCell.textContent = i.title

                const editCell = document.createElement("td")
                const editButton = document.createElement("button")
                editButton.className = "round edit"
                editButton.onclick = function() {
                    editItems(l.id)
                };
                editCell.appendChild(editButton)

                const dellCell = document.createElement("td")
                const dellButton = document.createElement("button")
                dellButton.className = "round dell"
                dellCell.appendChild(dellButton)

                row.appendChild(titleCell);
                row.appendChild(editCell);
                row.appendChild(dellCell);
                tbody.appendChild(row);
            })
        }
    </script>
</html>




















