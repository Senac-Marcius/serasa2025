<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>empréstimo</title>
    <style>
        h1 {
            text-align: center;
            color:white;
            background: linear-gradient(135deg, #6e8efb, #a777e3);
            text-shadow: 2px 2px 5px #1d0a754d;
        }
        h2{
            text-align: center;
            color:white;
            background: linear-gradient(135deg, #6e8efb, #a777e3);
            text-shadow: 2px 2px 5px #1d0a754d;
        }
        th{
            text-align: center;
            color:white;
            background: linear-gradient(135deg, #6e8efb, #a777e3);
            text-shadow: 2px 2px 5px #1d0a754d;
        }
        section{
            display: flex;
            flex-direction: column;
            margin: 0 auto;
        }

        #scRegister {}

        #scList {

        }
        .row{
            display:flex;
           
            
        }
        label {
            font-weight: 600;
        }
       
        button {
                background: linear-gradient(135deg, #6e8efb, #a777e3);
                color: white;
                border: none;
                padding: 12px 24px;
                font-size: 16px;
                font-weight: bold;
                border-radius: 8px;
                box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
                cursor: pointer;
                transition: all 0.3s ease-in-out;
                position: relative;
                overflow: hidden;
                margin: 20px auto 0;
                display: block;
            }

            button:hover {
                background: linear-gradient(135deg, #5b77e0, #925ec4);
                box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.3);
                transform: translateY(-2px);
            }

            button:active {
                transform: translateY(1px);
                box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.2);
            }

            button.round {
                width: 35px;
                height: 35px;
                border-radius: 50%;
            }

            button.edit{
                background:#ffff00;
            }

            button.dell{
                background:#ff0000;
            }


    </style>
</head>


<body>
    <h1> EMPRÉSTIMO</h1>
   
    
    <div class="row">
    
        
        <section id="scRegister">
            <h2>Deseja confirmar esse empréstimo?:</h2>
            <form>
                <input type="radio" id="html" name="fav_language" value="CONFIRMAR">
                <label for="Confirmar">Confirmar</label><br>
                <input type="radio" id="css" name="fav_language" value="RESERVAR">
                <label for="Reservar">Reservar</label><br>
                <input type="radio" id="voltar ao lobby" name="fav_language" value="VOLTAR AO LOBBY">
                <label for="voltar ao Catálogo">Voltar ao Catálogo</label>
                <p> <button type="button" onclick="alert('PROXIMO')">PRÓXIMO</button></p>
            </form>

            

            <h2>Dados para empréstimo</h2>
            
            <form>
                <input id="id" type="hidden" value="-1">
                <p> <label>Nome do livro:</label><input id="namebook" type="text" /><br></p>
                <p><label>Data de empréstimo:</label><input id="dateloan" type="date" /><br></p>
                <p><label>Data de devolução:</label><input id="datereturns" type="date" /><br></p>
                <p><label>Renovação:</label><input id="renewal" type="text" /><br></p>
                <p><label>Status de empréstimo:</label><input id="status" type="select" /><br></p>
                <p><label>observação:</label><input id="observation" type="text" /><br></p>
                    <p> <button type="button" id="register" onclick="handleRegister()">FINALIZAR</button></p>
            </form>
        </section>
    
    
        <section id="sclist">

            <table>
                <thead>
                    <th>Status de empréstimo:</th>
                </thead>
                <tbody>

                </tbody>
            </table>

        </section>
    </div>
</body>

<script>
    var loans = []

    function putLoan(req, id){

    let idx = loans.findIndex(l => l.id == id) //

    if (idx == -1) return "Não encontrado"

    if(req.userId != undefined) loans[idx].userId = req.userId
    if(req.bookId != undefined) loans[idx].bookId = req.bookId
    if(req.loanDate != undefined) loans[idx].loanDate = req.loanDate
    if(req.expectedLoanDate != undefined) loans[idx].expectedLoanDate = req.expectedLoanDate
    if(req. effectiveLoanDate!= undefined) loans[idx].effectiveLoanDate = req.effectiveLoanDate
    if(req.renewal != undefined) loans[idx].renewal = req.renewal
    if(req.penalty != undefined) loans[idx].penalty = req.penalty
    if(req.statusLoan != undefined) loans[idx].statusLoan = req.statusLoan
    if(req.observation != undefined) loans[idx].observation = req.observation

    return loans[idx]
}
    
    function setLoan(req) {
        let l = {
            id: loans.length,
            creatAt: req.creatAt,
            userId: req.userId,
            bookId: req.bookId,
            loanDate: req.loanDate,
            expectedLoanDate: req.expectedLoanDate,
            renewal: req.renewal,
            statusLoan: req.statusLoan,
            observation: req.observation
        }

        loans.push(l)
        return "Livro emprestado com sucesso"

    }

    function handleRegister() {
        let id = document.getElementById('id').value

        if(id == -1){
            console.log(
            setLoan({
                creatAt: "1999-02-02",
                userId: 0,
                bookId: document.getElementById("namebook").value,
                loanDate: document.getElementById("dateloan").value,
                expectedLoanDate: document.getElementById("datereturns").value,
                renewal: document.getElementById("renewal").value,
                statusLoan: document.getElementById("status").value,
                observation: document.getElementById("observation").value
            })
        )

        }else if(id > -1){
            let loanEdit = putLoan({
            userId: document.getElementById("userId").id,
            bookId: document.getElementById("namebook").value,
            loanDate: document.getElementById("dateloan").value,
            expectedLoanDate: document.getElementById("datereturns").value,
            renewal: document.getElementById("renewal").value,
            statusLoan: document.getElementById("status").value,
            observation: document.getElementById("observation").value
    }, id);

            document.getElementById('id').value = -1
        }else{
            console.log("erro")
        }
        
        listLoans(loans)
    }
    function editLoans(id){    //document.getElement
        let loan = loans.find(p => p.id == id)
        document.getElementById("namebook").value = loan.bookId
        document.getElementById("dateloan").value = loan.loanDate
        document.getElementById("datereturns").value = loan.expectedLoanDate
        document.getElementById("renewal").value = loan.renewal
        document.getElementById("status").value = loan.statusLoan
        document.getElementById("observation").value = loan.observation
        document.getElementById('id').value = id
    }


    function listLoans(pList) {
        const tbody = document.querySelector("#sclist tbody")
        tbody.innerHTML = ""

        loans.forEach(p => {
            const row = document.createElement("tr");
            
            
            const buttonEdit = document.createElement("td");
            buttonEdit.textContent = "Editar";
            const buttonEditElement = document.createElement("button");
            buttonEditElement.textContent = "Editar";
            buttonEditElement.className = "round edit";
            buttonEdit.appendChild(buttonEditElement);
            buttonEdit.onclick = function() {
            editLoans(p.id);  
        };
            buttonEdit.appendChild(buttonEditElement)

           
            const buttonDell = document.createElement("td");
            buttonDell.textContent = "Deletar"
            const buttonDeletarElement = document.createElement("button");
            buttonDeletarElement.textContent = "Deletar"
            buttonDell.appendChild(buttonDeletarElement)

            const statusLoanCell = document.createElement("td");
            statusLoanCell.textContent = p.statusLoan
            buttonDeletarElement.className = "round dell"

            
            row.appendChild(statusLoanCell);
            row.appendChild(buttonEdit);
            row.appendChild(buttonDell);

            tbody.appendChild(row);
            

        })
    }


</script>


</html>