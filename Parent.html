<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8"/> <!--UTF-8 é a quantidade de bist no caracter, portanto o html vai aceitar simbolos-->
        <title>Responsável</title>
        <style>
            body{
                margin: 0;
            }
            h1{
                text-align: center;
                color: #bf54a3;
                background-color: #f2f2f2;
                margin: 0;
            }
    
            section{
                display: flex;
                margin:0 auto;
                flex-direction:column;

            }
    
            #scRegister{

            }

            #scList{

            }
            .row{
                display: flex;
                margin-top: 50px;
                padding: 20px;
            }
            label{
                font: weight 600;
            }

            form{

                background-color: #f2f2f2;
                padding: 40px;
                border-radius: 25px;
                box-shadow: 0px 4px 10px rgba(0,0,0,0.2);
            }
            button {
                background: linear-gradient(135deg, #6e8efb, #a777e3);
                color: white;
                border: none;
                padding: 12px 24px;
                font-size: 16px;
                font-weight: bold;
                border-radius: 8px;
                box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
                cursor: pointer;
                transition: all 0.3s ease-in-out;
                position: relative;
                overflow: hidden;
                margin: 20px auto 0;
                display: block;
            }

            button:hover {
                background: linear-gradient(135deg, #5b77e0, #925ec4);
                box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.3);
                transform: translateY(-2px);
            }

            button:active {
                transform: translateY(1px);
                box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.2);
            }

            button.round{
                width: 35px;
                height: 35px;
                border-radius: 50%;
            }

            button.edit{
                background: #c4230a;
            }
            button.del{
                background: #925ec4;
            }

        </style>
    </head>
    <body>
        <H1>Cadastre seu responsável</H1>
        <div class="row">
            <section id ="scRegister">
            <form>
                <input id="id" type="hidden" value="-1"/>
                <label>Nome: </label><input id="name" type="text"/><br><br>
                <label>Idade: </label><input id="age"type="number"/><br><br>
                <label>Parentesco: </label><input id="kinship" type="text"/><br><br>
                <label>Telefone: </label><input id="phone" type="text"/><br><br>
                <label>Email: </label><input id="email" type="text"/><br><br>
                <button type="button" id="register" onclick="handleRegister()">Cadastrar: </button>
            </form>
        </section>
        
        <section id="scList"><!-- adicionando tabelas-->
            <table>
                <thead><br>
                    <th>nivel de parentesco:</th>
                </thead>
                <tbody>
            
                </tbody>
            </table>
        </section>
        </div>
        
    </body>
    <script>
        var parents=[]
        
        function setParent(req){
            const emailParent = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
            const phoneParent = /^\(\d{2}\)\s\d{4,5}-\d{4}$/;


            if(!emailParent.test(req.email)){
        return "Digite um email cadastrado"
            }

            if(!phoneParent.test(req.phone)){
        return "Digite um Phone cadastrado"
            }

    let p = {
        id: parents.length,
        name: req.name,
        age: req.age,
        level: req.level,
        kinship: req.kinship,
        creatAt: req.creatAt,
        phone: req.phone,
        email: req.email,
        userId: req.userId
    }
    parents.push(p)
    return "casdastro realizado"

}
        function putParent(req, id){
        let idx = parents.findIndex(p => p.id == id)

        if(idx == -1) return "Não encontrado"

        if(req.name != undefined) parents[idx].name = req.name
        if(req.age != undefined) parents[idx].age = req.age
        if(req.level != undefined) parents[idx].level = req.level
        if(req.kinship != undefined) parents[idx].kinship = req.kinship
        if(req.url != undefined) parents[idx].url = req.url
        if(req.phone != undefined) parents[idx].phone = req.phone
        if(req.email != undefined) parents[idx].email = req.email
    
        return parents[idx]
        }

        function handleRegister(){
            let id = document.getElementById("id").value
            if(id == -1){
                console.log(
                    setParent({
            
                        name: document.getElementById("name").value,
                        age: document.getElementById("age").value,
                        kinship: document.getElementById("kinship").value,
                        phone: document.getElementById("phone").value,
                        email: document.getElementById("email").value,
                        userid: 0
    
                    })

                )
            
            }else if(id > -1){
                console.log(
                    putParent({
            
                        name: document.getElementById("name").value,
                        age: document.getElementById("age").value,
                        kinship: document.getElementById("kinship").value,
                        phone: document.getElementById("phone").value,
                        email: document.getElementById("email").value,
                        userId: 0
                }, id))

                document.getElementById("id").value = -1
                
            }else{
            console.log("erro")
         }
         listParent(parents)
        }

        function editParent(id){
            let parent = parents.find(p => p.id == id)

            document.getElementById("name").value = parent.name
            document.getElementById("email").value = parent.email
            document.getElementById("age").value = parent.age
            document.getElementById("kinship").value = parent.kinship
            document.getElementById("phone").value = parent.phone
            document.getElementById("id").value = parent.id
           
            

        }
    
        function listParent(plist){
            const tbody = document.querySelector("#scList tbody")
            tbody.innerHTML = ""
            //forEach realiza os passos de forma automatica, executa a mesma função para todos os elementos dentro do vetor.
            plist.forEach( p => {
                const row = document.createElement("tr")
                const EmailKinship = document.createElement("td")
                EmailKinship.textContent = p.id

                const editEmail = document.createElement("td")
                const editButton = document.createElement("button")
                editButton.className = "round edit"
                editButton.onclick = function() {
                    editParent(p.id)
                }
                editEmail.appendChild(editButton)

                const delEmail = document.createElement("td")
                const delButton = document.createElement("button")
                delButton.className = "round dell"
                delEmail.appendChild(delButton)

            
                row.appendChild(EmailKinship);
                row.appendChild(editEmail)
                row.appendChild(delEmail)
                tbody.appendChild(row);
            })
        }
    </script>
</html>